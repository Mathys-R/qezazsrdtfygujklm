{% extends "base.html" %}

{% block title %}Accueil - GradeMaster{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2>Liste des Élèves</h2>
        <a href="{{ url_for('main.add_student') }}" class="btn btn-primary">Nouvel Élève</a>
    </div>

    {% if students %}
    <table>
        <thead>
            <tr>
                <th>Nom</th>
                <th>Email</th>
                <th>Nombre de notes</th>
                <th>Moyenne Générale</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for item in students %}
            <tr>
                <td>{{ item.student.first_name }} {{ item.student.last_name }}</td>
                <td>{{ item.student.email }}</td>
                <td>{{ item.grade_count }}</td>
                <td>
                    {% if item.average is not none %}
                    <span
                        class="badge {% if item.average >= 15 %}badge-success{% elif item.average >= 10 %}badge-warning{% else %}badge-danger{% endif %}">
                        {{ "%.2f"|format(item.average) }}/20
                    </span>
                    {% else %}
                    <span style="color: #94a3b8;">N/A</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('main.student_detail', id=item.student.id) }}"
                        style="color: var(--primary-color); font-weight: 500; text-decoration: none;">Voir détails
                        &rarr;</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
        <p>Aucun élève enregistré pour le moment.</p>
        <a href="{{ url_for('main.add_student') }}" style="color: var(--primary-color);">Ajouter le premier élève</a>
    </div>
    {% endif %}
</div>
{% endblock %}